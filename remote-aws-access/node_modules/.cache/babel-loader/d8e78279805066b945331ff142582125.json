{"ast":null,"code":"import _slicedToArray from\"/Users/nicholaws/Documents/final_year_project/remote-aws-access/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import{addHook}from'./components/SingletonHooksContainer';import{batch}from'./utils/env';export var singletonHook=function singletonHook(initValue,useHookBody){var mounted=false;var lastKnownState=initValue;var consumers=[];var applyStateChange=function applyStateChange(newState){lastKnownState=newState;batch(function(){return consumers.forEach(function(c){return c(newState);});});};return function(){var _useState=useState(lastKnownState),_useState2=_slicedToArray(_useState,2),state=_useState2[0],setState=_useState2[1];if(!mounted){mounted=true;addHook({initValue:initValue,useHookBody:useHookBody,applyStateChange:applyStateChange});}useEffect(function(){consumers.push(setState);if(lastKnownState!==state){setState(lastKnownState);}return function(){consumers.splice(consumers.indexOf(setState),1);};// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return state;};};","map":{"version":3,"sources":["/Users/nicholaws/Documents/final_year_project/remote-aws-access/src/components/react-singleton-hook/src/singletonHook.js"],"names":["useEffect","useState","addHook","batch","singletonHook","initValue","useHookBody","mounted","lastKnownState","consumers","applyStateChange","newState","forEach","c","state","setState","push","splice","indexOf"],"mappings":"kJAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,OAAT,KAAwB,sCAAxB,CACA,OAASC,KAAT,KAAsB,aAAtB,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,SAAD,CAAYC,WAAZ,CAA4B,CACvD,GAAIC,CAAAA,OAAO,CAAG,KAAd,CACA,GAAIC,CAAAA,cAAc,CAAGH,SAArB,CACA,GAAII,CAAAA,SAAS,CAAG,EAAhB,CAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,QAAD,CAAc,CACrCH,cAAc,CAAGG,QAAjB,CACAR,KAAK,CAAC,iBAAMM,CAAAA,SAAS,CAACG,OAAV,CAAkB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACF,QAAD,CAAL,EAAnB,CAAN,EAAD,CAAL,CACD,CAHD,CAKA,MAAO,WAAM,eACeV,QAAQ,CAACO,cAAD,CADvB,wCACJM,KADI,eACGC,QADH,eAGX,GAAI,CAACR,OAAL,CAAc,CACZA,OAAO,CAAG,IAAV,CACAL,OAAO,CAAC,CAAEG,SAAS,CAATA,SAAF,CAAaC,WAAW,CAAXA,WAAb,CAA0BI,gBAAgB,CAAhBA,gBAA1B,CAAD,CAAP,CACD,CAEDV,SAAS,CAAC,UAAM,CACdS,SAAS,CAACO,IAAV,CAAeD,QAAf,EACA,GAAIP,cAAc,GAAKM,KAAvB,CAA8B,CAC5BC,QAAQ,CAACP,cAAD,CAAR,CACD,CACD,MAAO,WAAM,CAAEC,SAAS,CAACQ,MAAV,CAAiBR,SAAS,CAACS,OAAV,CAAkBH,QAAlB,CAAjB,CAA8C,CAA9C,EAAmD,CAAlE,CAEA;AACD,CARQ,CAQN,EARM,CAAT,CAUA,MAAOD,CAAAA,KAAP,CACD,CAnBD,CAoBD,CA9BM","sourcesContent":["import { useEffect, useState } from 'react';\nimport { addHook } from './components/SingletonHooksContainer';\nimport { batch } from './utils/env';\n\nexport const singletonHook = (initValue, useHookBody) => {\n  let mounted = false;\n  let lastKnownState = initValue;\n  let consumers = [];\n\n  const applyStateChange = (newState) => {\n    lastKnownState = newState;\n    batch(() => consumers.forEach(c => c(newState)));\n  };\n\n  return () => {\n    const [state, setState] = useState(lastKnownState);\n\n    if (!mounted) {\n      mounted = true;\n      addHook({ initValue, useHookBody, applyStateChange });\n    }\n\n    useEffect(() => {\n      consumers.push(setState);\n      if (lastKnownState !== state) {\n        setState(lastKnownState);\n      }\n      return () => { consumers.splice(consumers.indexOf(setState), 1); };\n\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return state;\n  };\n};\n"]},"metadata":{},"sourceType":"module"}